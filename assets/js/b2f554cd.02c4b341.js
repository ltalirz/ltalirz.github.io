"use strict";(self.webpackChunkhomepage=self.webpackChunkhomepage||[]).push([[894],{6042:e=>{e.exports=JSON.parse('{"blogPosts":[{"id":"numpy-scipy-mkl","metadata":{"permalink":"/blog/numpy-scipy-mkl","editUrl":"https://github.com/ltalirz/ltalirz.github.io/edit/master/blog/2016-04-11-numpy-mkl.md","source":"@site/blog/2016-04-11-numpy-mkl.md","title":"Link numpy & scipy against the MKL","description":"The pip package management system is a very convenient way of managing custom python installations that are not managed by the operating system (such as virtual python environments).","date":"2016-04-11T00:00:00.000Z","formattedDate":"April 11, 2016","tags":[{"label":"python","permalink":"/blog/tags/python"},{"label":"numpy","permalink":"/blog/tags/numpy"},{"label":"scipy","permalink":"/blog/tags/scipy"},{"label":"mkl","permalink":"/blog/tags/mkl"}],"readingTime":1.26,"hasTruncateMarker":true,"authors":[{"name":"Leopold Talirz","title":"Computational Materials Scientist","url":"https://github.com/ltalirz","imageURL":"https://github.com/ltalirz.png","key":"ltalirz"}],"frontMatter":{"slug":"numpy-scipy-mkl","title":"Link numpy & scipy against the MKL","authors":"ltalirz","tags":["python","numpy","scipy","mkl"]},"unlisted":false,"nextItem":{"title":"Importing cube files into Blender","permalink":"/blog/cube-files-blender"}},"content":"The pip package management system is a very convenient way of managing custom python installations that are not managed by the operating system (such as [virtual python environments](https://virtualenv.pypa.io/en/latest/)).\\n\\npip install numpy scipy essentially works out of the box. Yet, when it comes to numpy and scipy, significant speed can be gained by [linking these modules against the Intel Math Kernel Library (MKL)](https://software.intel.com/en-us/articles/numpyscipy-with-intel-mkl) for linear algebra operations.\\n\\n\x3c!--truncate--\x3e\\n\\nYou can tell pip to do that in the following way:\\n\\n(1) Tell numpy where to find the MKL\\n\\nCreate a file `.numpy-site.cfg` in your home directory with a content similar to \\n```toml\\n[mkl]\\nlibrary_dirs = /opt/intel/composer_xe_2013.1.117/mkl/lib/intel64\\ninclude_dirs = /opt/intel/composer_xe_2013.1.117/mkl/include\\nmkl_libs = mkl_rt\\nlapack_libs =\\n```\\n\\n(2) Tell pip to use the Intel compiler\\n\\n```bash\\npip install numpy \\\\\\n--global-option=\\"config\\" \\\\\\n--global-option=\\"--compiler=intelem\\" \\\\\\n--global-option=\\"build_clib\\" \\\\\\n--global-option=\\"--compiler=intelem\\" \\\\\\n--global-option=\\"build_ext\\" \\\\\\n--global-option=\\"--compiler=intelem\\"\\n\\npip install scipy \\\\\\n--global-option=\\"config\\" \\\\\\n--global-option=\\"--compiler=intelem\\" \\\\\\n--global-option=\\"--fcompiler=intelem\\" \\\\\\n--global-option=\\"build_clib\\" \\\\\\n--global-option=\\"--compiler=intelem\\" \\\\\\n--global-option=\\"--fcompiler=intelem\\" \\\\\\n--global-option=\\"build_ext\\" \\\\\\n--global-option=\\"--compiler=intelem\\" \\\\\\n--global-option=\\"--fcompiler=intelem\\"\\n```\\n\\n\\nAlternatively, you may also create a file `.pydistutils.cfg` in your home directory with content\\n```toml\\n[config]\\ncompiler=intelem\\nfcompiler=intelem\\n[build_clib]\\ncompiler=intelem\\nfcompiler=intelem\\n[build]\\ncompiler=intelem\\n[build_ext]\\ncompiler=intelem\\nfcompiler=intelem\\n```\\n\\nand then simply run\\n```bash\\npip install numpy\\npip install scipy\\n```\\n\\nNote: If you don\'t provide this info to pip, it will look for and use the GNU compiler collection by default.\\n\\nNote: While numpy installed without problems I did receive a compilation error with icc 14.0.0. Possibly related to [this](https://mail.scipy.org/pipermail/scipy-dev/2013-March/018506.html).\\n\\nParts (1) and (2) relied on the following StackExchange posts\\n * http://stackoverflow.com/questions/13769936/supplying-numpy-site-cfg-arguments-to-pip\\n * http://stackoverflow.com/questions/15725869/pass-build-ext-options-to-pip-install"},{"id":"cube-files-blender","metadata":{"permalink":"/blog/cube-files-blender","editUrl":"https://github.com/ltalirz/ltalirz.github.io/edit/master/blog/2016-03-24-cube-files-blender/index.md","source":"@site/blog/2016-03-24-cube-files-blender/index.md","title":"Importing cube files into Blender","description":"In this post, we are going to import the grid data from a Gaussian cube file into Blender, an open-source 3d graphics software.","date":"2016-03-24T00:00:00.000Z","formattedDate":"March 24, 2016","tags":[{"label":"blender","permalink":"/blog/tags/blender"},{"label":"cube","permalink":"/blog/tags/cube"}],"readingTime":3.78,"hasTruncateMarker":true,"authors":[{"name":"Leopold Talirz","title":"Computational Materials Scientist","url":"https://github.com/ltalirz","imageURL":"https://github.com/ltalirz.png","key":"ltalirz"}],"frontMatter":{"slug":"cube-files-blender","title":"Importing cube files into Blender","authors":"ltalirz","tags":["blender","cube"]},"unlisted":false,"prevItem":{"title":"Link numpy & scipy against the MKL","permalink":"/blog/numpy-scipy-mkl"}},"content":"In this post, we are going to import the grid data from a [Gaussian cube file](http://paulbourke.net/dataformats/cube/) into [Blender](https://www.blender.org/), an open-source 3d graphics software.\\n\\n\x3c!--truncate--\x3e\\n\\nWhy this effort? In the atomistic simulations community, we are used to displaying wave functions and electron densities as isosurfaces and lots of software exists that makes this process very easy. But an isosurface doesn\'t tell the whole story. Blender gives us the opportunity to visualize the electron density as a kind of \\"smoke cloud\\", where the density determines how light scatters going through the cloud (we may then add an intrinsic glow to the cloud as well). While this is not needed in the daily routine of understanding the basic features of an electron distribution, it allows to convey the inherent fuzzyness in a single image.\\n\\nOf course, there is many more reasons, why one may want to use Blender. Among its many features, some of the ones relevant to atomistic simulations are\\n\\n 1. a great graphical user interface[^1]\\nray-tracing capabilities\\n 1. advanced animation capabilities (including physics!)\\n 1. a Python interface that allows for automating workflows\\n\\nHowever, Blender was originally developed for animation studios, and so the import of file formats customary in atomistic simulations is not always straightforward.\\n\\nFor atomic structure data, several routes are already available\\n\\n * The [XYZ addon](https://wiki.blender.org/index.php/Extensions:2.6/Py/Scripts/Import-Export/XYZ) for directly importing XYZ (.xyz) files into Blender\\n * Via [VMD](http://www.ks.uiuc.edu/Research/vmd/), exporting to the Wavefront Objects (.obj/.mtl), which can be imported by Blender\\n  This allows not only to import atomic structure models, but also isosurfaces etc.\\n * Via [ASE](https://wiki.fysik.dtu.dk/ase/), exporting to the X3D (.x3d) format, which can be imported by Blender\\n\\nBut how would we go about importing a function f(x,y,z) defined on a regular 3d grid, such as an orbital wave function or electron density? In this post, we are going to import the grid data from a Gaussian cube file.\\n\\nFirst, we have to note that the capability to render this kind data (called \\"[voxels](https://en.wikipedia.org/wiki/Voxel)\\" in the Blender community) is currently [available only for the internal \\"Blender Render\\"](https://developer.blender.org/T41179) engine. While the \\"Cycles Render\\" engine is being used and developed more actively, we will have to abandon it for now. \\"Blender Internal\\" offers two alternative file formats for importing voxel data\\n * \\"8bit raw\\", in which f(x,y,z) is stored as integers ranging from 0 to 255\\n * \\"Blender voxel\\", in which f(x,y,z) is stored as 32bit floats. \\n\\nThe first format is basically unusable for wave functions/densities of molecules - a relative accuracy of 1/256 doesn\'t get you very far when sampling exponential decays. We thus choose the latter format.\\n\\nSo, we need to convert the .cube file into a .bvox file. Adapting [a post by Matthias Meschede](http://pythology.blogspot.co.uk/2014/08/you-can-do-cool-stuff-with-manual.html), this is easily achieved using a combination of ASE and numpy: \\n\\n```python\\n#!/usr/bin/env python\\nimport ase.io.cube\\nimport numpy as np\\nimport os\\n\\nfname = \'PROJ-WFN_00183_1-1_0.cube\'\\nprint(\\"Reading cube file {}\\".format(fname))\\ndata, atoms = ase.io.cube.read_cube_data(fname)\\n\\n# Here, I want the electron density, not the wave function\\ndata = data**2\\n\\n# If data is too large, just reduce it by striding with steps >1\\nsx, sy, sz = 1, 1, 1\\ndata = data[::sx,::sy,::sz]\\n\\n# Note the reversed order!!\\nnz, ny, nx = data.shape\\nnframes = 1\\nheader = np.array([nx,ny,nz,nframes])\\n\\n#open and write to file\\nvdata = data.flatten() / np.max(data)\\nvfname = os.path.splitext(fname)[0] + \'.bvox\'\\nvfile = open(vfname,\'wb\')\\nprint(\\"Writing Blender voxel file {}\\".format(vfname))\\nheader.astype(\'<i4\').tofile(vfile)\\nvdata.astype(\'<f4\').tofile(vfile)\\n```\\n\\n\\nNow we need to load the file into Blender. The steps are essentially the following\\n\\n\\n 1. Open Blender and select \\"Blender Render\\"\\n 1. Select the default cube, set its material to \\"Volume\\" and its \\"Density\\" to 0\\n    ![default cube](./bl1.png)\\n 1. Add a new texture of type \\"Voxel Data\\", file format \\"Blender Voxel\\" and load the file\\n   Note: You don\'t get any confirmation of the file being loaded but if you don\'t get an error message, assume that it is.\\n 1. Activate \\"Still frame\\" and set still frame number to 1 (not 0!)\\n    ![still frame](./bl2.png)\\n 1. Activate influence on density and emission and ramp up the intensity until you see something in the rendered output. Note: You may never see anything in the preview window - don\'t let this confuse you. should be able to continue by yourself and unleash your creativity on the voxels!\\n    ![density](./bl3.png)\\n\\nTo give you one possible idea of what can be done, here is what I came up with for my first Blender project\\n\\n![End state of N=7 armchair graphene nanoribbon](./gnr.png)  \\n*End state of N=7 armchair graphene nanoribbon*\\n\\n\\nCheers!\\n\\n\\n[^1]: This may sound trivial, but alternatives, such as POV-ray may have no gui whatsoever."}]}')}}]);